# 概论
数据库：按照特定数据模型组织、存储和管理数据的文件集合

数据模型：描述事物对象数据特征及其结构的形式化表示，包含数据结构、数据操作、数据约束3个部分
层次、网状、关系、其它数据模型

数据库系统：基于数据库进行数据管理与信息服务的软件系统
组成：用户、数据库应用程序、数据库管理系统(DBMS)、数据库

数据库管理系统(DBMS)：专门用来创建、管理、维护数据库，并提供外部对数据库进行访问的系统软件

数据库应用系统类型：业务处理系统、管理信息系统、决策支持系统
数据库系统应用结构：单机用户结构、集中式结构、客户/服务器结构、分布式结构

关系数据库中数据内容：
- 用户数据
- 元数据：定义数据库对象（表、列、索引、视图）的数据（描述数据的数据）
- 索引数据
- 运行数据
- 其它数据

# 关系模型
关系模型：基于二维表结构存储数据实体及实体间联系的数据模型
实体：包含有数据特征的事物对象在概念模型世界中抽象名称
关系（关系表）：有关系特征、用于存放实体数据的二维表

键：用来唯一表示元组的属性列
候选键：一个关系中可能有多个列，每个键称为候选键
主键：关系表中最有代表性的**一个**候选键
复合键：多个属性所构成的键
代理键：DBMS自动生成的数字序列作为关系表的主键
外键：通过主键属性相关联的两个关系表中，该主键属性在一个表中作为主键，在另一个表中作为外键

关系模型完整性：在关系数据模型中对关系实施的完整性约束
组成：
- 实体完整性约束
	在关系表中实施的主键取值约束，保证每个元组唯一标识
	规则：
	1. 主键属性列不允许为NULL
	2. 主键取值唯一
- 参照完整性约束
	关系表之间需要遵守的数据约束，保证关系之间关联列的数据一致性
	规则：若关系R中外键F与关系S中主键K关联，则F、K值一致
- 用户自定义完整性约束
	用户根据具体业务对数据处理规则要求所定义的数据约束

**关系运算**
# SQL语言
1. 数据定义语言（DDL）：CREATE、DROP、ALTER
2. 数据操纵语言（DML）：INSERT、UPDATE、DELETE
3. 数据查询语言（DQL）
4. 数据控制语言（DCL）：GRANT、DENY、REVOKE
5. 事物处理语言（TPL）：BEGIN TRANSACTION、COMMIT、ROLLBACK
6. 游标控制语言（CCL）：DECLARE CURSOR、FETCH INTO、CLOSE CURSOR

列完整性约束：
- PRIMARY KEY
- NOT NULL
- NULL
- UNIQUE
- CHECK：`CHECK(<行名> IN('<value1>', 'value2', 'value3'))`
- DEFAULT：`DEFAULT 'value'`
表约束：
- 复合主键
	`CONSTRAINT <复合键名> PRIMARY Key(<列名1>, <列名2>)`
- 代理键
	`CONSTRAINT <代理键名> PRIMARY Key(<列名>)`
	`<列名>`需是：`serial`
- 外键
	`CONSTRAINT <外键名> FOREIGN Key(外键列名) REFERENCES <参照表>(参照列)`

DDL：
- 增删 表、列、完整性约束、索引
- 修改 表、列、完整性约束、索引 名
- 修改 列属性
```sql
--增加 default 约束
ALTER TABLE 表名
ALTER COLUMN 列名 SET DEFAULT 默认值;

--修改约束名
ALTER TABLE 表名
RENAME CONSTRAINT 旧约束名 TO 新约束名;
```
新增列时**不能添加**`NULL`，数据库不知道如何为所有行添加该属性值，可设为`DEFAULT`或`NOT NULL`

DML：
插入、更新、删除 表数据

DQL：
- 限定范围
- 通配符
- 逻辑运算
- `IN`
- 排序`DESC`、`ASC`
- 聚合函数
- 分组统计
- `HAVING`筛选分组
- 子查询
- 两种连接关联查询

DCL：
- 授予、收回、拒绝 权限

视图的创建、删除
通过视图查询、查询视图
# 数据库设计
数据库设计：应用架构设计、结构模型设计、访问方式设计
数据库结构模型：
- 概念数据模型（CDM）
- 逻辑数据模型（LDM）
- 物理数据模型（PDM）

| CDM             | LDM                             | PDM     |
| --------------- | ------------------------------- | ------- |
| 实体              | 实体                              | 表       |
| 属性              | 属性                              | 列       |
| 标识符（Identifier） | 标识符（Primary/Foreign Identifier） | 键       |
| 联系              | 联系                              | 参照完整性约束 |
ER图元素：
1. 实体
2. 属性
3. 标识符
4. 联系
	联系度数：联系中关联实体数目
	基数：可能参与联系的实例的数量

实体-联系类型：
1. 多重性分类
	- 1对1
	- 1对多
	- 多对多
2. 参与性分类
	- 可选
	- 强制
3. 继承性分类
	- 互斥继承：父实体中的一个实例只能属于某个子实体
	- 非互斥继承：父实体的一个实例可以属于多个子实体
	- 完整继承：父实体中的实例完整地被各个子实体分别继承
	- 非完整继承

强弱实体：一个实体（弱实体）的存在必须以另一个实体（强实体）的存在为前提
弱实体：
- 标识符依赖弱实体
- 非标识符弱实体

数据库建模设计：
1. CDM：
	- 定义实体、实体联系、实体属性、标识符
	- 不定义主、外键
2. LDM：
	- 主、外键定义
	- 范式检查
3. PDM：
	1. 实体→关系表
		- 设置代理键
		- 设置列特性
	2. 弱实体→关系表
		- 非标识符依赖：弱实体关系表中加入强实体标识符做外键
		- 标识符依赖：弱实体关系表中加入强实体标识符做外键，并与若实体标识符一起做复合主键
	3. 实体联系转换
		- 1:1转换：一个表主键放入另一个表做外键
		- 1:N转换：1端主键放入N端做外键
		- M:N转换：增加关联表，M、N端实体在关联表中做复合主键、外键
		- 1:1转换：
	4. 实体继承联系转换
		父表主键放在子表做主、外键
	5. 实体递归联系转换
		- 1:N递归联系：关系表中添加一个参照约束于主键的外键
		- M:N递归联系：增加关联表，原表的主键在关联表中派生两次做复合主键、外键